<!DOCTYPE html>
<html class="no-js chayns--web" lang="en">
<head>
  <meta charset="utf-8">
  <title>chayns.css dev page</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no, minimum-scale=1, maximum-scale=1">
  <link rel="stylesheet" href="dist/chayns.css">
  <style>
    .mode--dev .tapp {
      border: 1px solid #000;
    }
    .code {
      margin-bottom: 10px;
    }

  </style>
</head>
<body>
  <div class="tapp">

    <div class="tapp__intro">
      <h1 class="headline">Chayns V3</h1>
      Here you can place your intro text for your lovely Chayns V3 Tapp! :)
    </div>

    <div class="tapp__content is-dark">
      <h2 class="headline">Overview</h2>
      <ul>
        <li><a href="#">Style</a></li>
        <li><a href="#">Functions</a></li>
      </ul>
    </div>

    <div class="tapp__content is-dark">
      <h2 class="headline">Grids</h2>
      <div class="u1/2-mobile u1/2-desktop">1</div>
      <div class="u1/2-mobile u1/2-desktop">1</div>
      <h3 class="headline">Table</h3>
      <h3 class="headline">CSS Table</h3>
    </div>

    <div class="tapp__content is-dark">
      <h2 class="headline">Buttons</h2>
      <h3 class="headline">Standard Button</h3>
      <pre class="code"><code>Button Code</code></pre>
      <div class="button">.button</div>
      <button class="button">.button</button>
      <h3 class="headline">Choose Button</h3>
      <button class="button">.button--choose</button>
      <button class="button" onclick="chayns.dialog.alert('test Alert');">HTML Dialog</button>

    </div>

    <div class="tapp__content is-dark">
      <h2 class="headline">Forms</h2>
      <h3 class="headline">Text</h3>
      <input type="text" class="input" name="text" placeholder="Text">
      <br>
      <input type="text" class="input input--dark" name="text" placeholder="Text">
      <h3 class="headline">Checkbox</h3>
      <label for="check">
        <input type="checkbox" name="check" id="check">
        Checkbox
      </label>
      <h3 class="headline">Radiobox</h3>
      <label for="radio">
        <input type="radio" name="radio" id="radio">
        Radio
      </label>
      <label for="radio2">
        <input type="radio" name="radio" id="radio2">
        Radio
      </label>
      <h3 class="headline">Switch</h3>
      TODO: responsive switch
    </div>

    <div class="tapp__content">

      <h2 class="headline">Accordion</h2>

      <div class="accordion accordion--margin">
        <div class="accordion__head">Inner Accordion</div>
        <div class="accordion__body">
          <div class="accordion__content">
            Text Content
          </div>
        </div>
      </div>

      <div class="accordion">
        <div class="accordion__head">Standard Accordion</div>
        <div class="accordion__body">
          <div class="accordion__content">
            Text Content
          </div>
        </div>
      </div>

      <div class="accordion">
        <div class="accordion__head">List Accordion</div>
        <div class="accordion__body">
          <div class="accordion__content">
            <div class="item">Item #1</div>
            <div class="item">Item #2</div>
            <div class="item">Item #3</div>
            <div class="item">Item #4</div>
            <div class="item">Item #5</div>
            <div class="item">Item #6</div>
            <div class="item">Item #7</div>
            <div class="item">Item #8</div>
            <div class="item">Item #9</div>
          </div>
        </div>
      </div>


    </div>

    <div class="tapp__content is-dark">
      <h3 class="headline">Grey container</h3>
      <div class="accordion">
        <div class="accordion__head">Standard Accordion on dark</div>
        <div class="accordion__body">
          <div class="accordion__content">
            Text Content
          </div>
        </div>
      </div>
    </div>

    <div class="tapp__content accordion accordion--margin">
      <h3 class="headline">Accordion as Tapp with margin</h3>
      <div class="accordion__head">Tapp Content Accordion</div>
      <div class="accordion__body">
        <div class="accordion__content">
          Text Content
        </div>
      </div>
    </div>

    <div class="tapp__content accordion">
      <div class="accordion__head">Tapp Content Accordion</div>
      <div class="accordion__body">
        <div class="accordion__content">
          Text Content
        </div>
      </div>
    </div>

  </div>


  <div class="grid">
    <div class="grid__item c-1-2-mobile c-1-4-desktop">50</div><!--
    --><div class="grid__item c-1-2-mobile c-1-4-desktop">50</div><!--
    --><div class="grid__item c-1-2-mobile c-1-4-desktop">50</div><!--
    --><div class="grid__item c-1-2-mobile c-1-4-desktop">50</div>
  </div>

  <div class="chayns__root" id="chayns-root">
    <div class="chayns__dialog">
      <div class="dialog__background"></div>
      <div class="dialog__content">
        <div class="dialog__box">
          <div class="dialog__headline"><h1 class="headline">Headline</h1></div>
          <div class="dialog__body">Body Text</div>
          <div class="dialog__buttons">
            <button class="button" onclick="chayns.dialog.close();">OK</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="//chayns1.tobit.com/SlitteRessource/API/v3/js/chayns.js"></script>
  <script>
    /* global chayns */
    if (typeof chayns === 'undefined') {
      throw new Error('There is no chayns :(');
    }
    var log = chayns.getLogger('pw.css');
    /**
     * chayns.ready promise
     */
    chayns.ready().then(function(data) {
      log.info('Chayns is ready: ', data);



    }, function() {
      log.info('Chayns is ready without being in Chayns Web or Chayns App.');
    }).then(function() {
      console.log('finally/always');
      //FastClick.attach(document.body);
    });

    var accordion = (function(window, document, undefined) {
      var accordions;

      function init() {
        accordions = document.querySelectorAll('.accordion .accordion__head');
//        var handleTouchEvent = function handleTouchEvent(e) {
//          var target = e.currentTarget;
//          function listener() {
//            target.removeEventListener('touchend', listener);
//            handleClickEvent.call(undefined, e);
//          }
//          target.addEventListener('touchend', listener);
//        };
        var i, l;
        for(i = 0, l = accordions.length; i < l; i++) {
          var accordion = accordions[i];
          accordion.addEventListener('click', handleClickEvent);
//          accordion.addEventListener('touchstart', handleTouchEvent);
        }
      }

      function dispose() {
        accordions.forEach(function(listener) {
          listener.removeEventListener('click', handleClickEvent);
        });
      }

      function handleClickEvent(e) {
        var accordion = e.currentTarget.parentElement;
        toggleAccordion(accordion);
        e.preventDefault();
        e.stopPropagation();
      }

      function toggleAccordion(accordion) {
        var height = 0;
        var body = accordion.querySelector('.accordion__body');
        var classList = accordion.classList;
        if (!classList.contains('accordion--open')) {
          trigger(accordion, 'open');
          height = accordion.querySelector('.accordion__content').offsetHeight + 'px';
          function listener() {
            trigger(accordion, 'opened');
            body.removeEventListener('transitionend', listener);
          }
          body.addEventListener('transitionend', listener, false);
        } else {
          trigger(accordion, 'close');
          function listener() {
            body.removeEventListener('transitionend', listener);
            trigger(accordion, 'closed');
          }
          body.addEventListener('transitionend', listener, false);
        }
        body.style['max-height'] = height;
        classList.toggle('accordion--open');
      }

      function trigger(element, eventName) {
        var event = new CustomEvent(eventName);
        return !element.dispatchEvent(event); // returns cancelled
      }


      // Alternative attempt to set the max-height
//      function addCSSRule(selector, rules) {
//        var sheet = document.styleSheets[0];
//        if('insertRule' in sheet) {
//          sheet.insertRule(selector + "{" + rules + "}", undefined);
//        }
//        else if('addRule' in sheet) {
//          sheet.addRule(selector, rules);
//        }
//      }

      return {
        init: init,
        dispose: dispose
      };
    })(window, document);

    accordion.init();

    // events example
    var firstAccordion = document.querySelectorAll('.accordion')[2];
    firstAccordion.addEventListener('open', log.info.bind(log, 'open event'), false);
    firstAccordion.addEventListener('close', log.info.bind(log, 'close event'), false);
    firstAccordion.addEventListener('opened', log.info.bind(log, 'closed event'), false);
    firstAccordion.addEventListener('closed', log.info.bind(log, 'closed event'), false);

//    var chaynsRoot = document.getElementById('chayns-root');
//    chaynsRoot.querySelector('.chayns__dialog').style.display = 'block';
//    chaynsRoot.querySelector('.chayns__dialog').style.opacity = '1';
//    chaynsRoot.querySelector('.dialog__content').style.top = window.innerHeight / 2 - 55 + 'px';
  </script>

</body>
</html>
